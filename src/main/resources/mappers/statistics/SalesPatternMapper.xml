<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.harusari.chainware.statistics.query.mapper.SalesPatternMapper">

    <select id="selectHourlySalesByFranchise" resultType="com.harusari.chainware.statistics.query.dto.HourlySalesResponse">
        SELECT
        HOUR(s.sold_at) AS hour,
        SUM(s.total_amount) AS totalAmount
        FROM sales s
        WHERE s.franchise_id = #{franchiseId}
        AND DATE(s.sold_at) = #{targetDate}
        GROUP BY hour
        ORDER BY hour
    </select>

    <select id="selectHourlySalesForHeadquarters" resultType="com.harusari.chainware.statistics.query.dto.HourlySalesResponse">
        SELECT
        HOUR(s.sold_at) AS hour,
        SUM(s.total_amount) AS totalAmount
        FROM sales s
        WHERE DATE(s.sold_at) = #{targetDate}
        GROUP BY hour
        ORDER BY hour
    </select>

</mapper>
